!function(t,n){var e={Identity:function(t){return t},True:function(){return!0},Blank:function(){}},r="boolean",u="number",o="string",i="object",a=typeof n,c="function",f={createLambda:function(t){if(null==t)return e.Identity;if(typeof t==o){if(""==t)return e.Identity;if(-1==t.indexOf("=>")){for(var n,r=new RegExp("[$]+","g"),u=0;n=r.exec(t);){var i=n[0].length;i>u&&(u=i)}for(var a=[],c=1;c<=u;c++){for(var f="",s=0;s<c;s++)f+="$";a.push(f)}var l=Array.prototype.join.call(a,",");return new Function(l,"return "+t)}var p=t.match(/^[(\s]*([^()]*?)[)\s]*=>(.*)/);return new Function(p[1],"return "+p[2])}return t},isIEnumerable:function(t){if(typeof Enumerator!==a)try{return new Enumerator(t),!0}catch(t){}return!1},defineProperty:null!=Object.defineProperties?function(t,n,e){Object.defineProperty(t,n,{enumerable:!1,configurable:!0,writable:!0,value:e})}:function(t,n,e){t[n]=e},compare:function(t,n){return t===n?0:t>n?1:-1},dispose:function(t){null!=t&&t.dispose()}},s=0,l=1,p=2,h=function(t,n,e){var r=new d,u=s;this.current=r.current,this.reset=function(){throw new Error("Reset is not supported")},this.moveNext=function(){try{switch(u){case s:u=l,t();case l:return!!n.apply(r)||(this.dispose(),!1);case p:return!1}}catch(t){throw this.dispose(),t}},this.dispose=function(){if(u==l)try{e()}finally{u=p}}},y={};ss.initAssembly(y,"linq"),ss.initClass(h,y,{},null,[ss.IDisposable]);var d=function(){var t=null;this.current=function(){return t},this.yieldReturn=function(n){return t=n,!0},this.yieldBreak=function(){return!1}},m=function(t){this.getEnumerator=t};ss.initClass(m,y,{},null,[ss.IEnumerable]),(m.Utils={}).createLambda=function(t){return f.createLambda(t)},m.Utils.createEnumerable=function(t){return new m(t)},m.Utils.createEnumerator=function(t,n,e){return new h(t,n,e)},m.Utils.extendTo=function(t){var n,e=t.prototype;for(var r in t===Array?(n=E.prototype,f.defineProperty(e,"getSource",function(){return this})):(n=m.prototype,f.defineProperty(e,"getEnumerator",function(){return m.from(this).getEnumerator()})),n){var u=n[r];e[r]!=u&&(null!=e[r]&&e[r+="ByLinq"]==u||u instanceof Function&&f.defineProperty(e,r,u))}},m.choice=function(){var t=arguments;return new m(function(){return new h(function(){t=t[0]instanceof Array?t[0]:null!=t[0].getEnumerator?t[0].toArray():t},function(){return this.yieldReturn(t[Math.floor(Math.random()*t.length)])},e.Blank)})},m.cycle=function(){var t=arguments;return new m(function(){var n=0;return new h(function(){t=t[0]instanceof Array?t[0]:null!=t[0].getEnumerator?t[0].toArray():t},function(){return n>=t.length&&(n=0),this.yieldReturn(t[n++])},e.Blank)})},m.empty=function(){return new m(function(){return new h(e.Blank,function(){return!1},e.Blank)})},m.from=function(t){if(null==t)return m.empty();if(t instanceof m)return t;if(typeof t==u||typeof t==r)return m.repeat(t,1);if(typeof t==o)return new m(function(){var n=0;return new h(e.Blank,function(){return n<t.length&&this.yieldReturn(t.charAt(n++))},e.Blank)});var n,a=ss.safeCast(t,ss.IEnumerable);if(a)return new m(function(){return new h(function(){n=ss.getEnumerator(a)},function(){return!!n.moveNext()&&this.yieldReturn(n.current())},function(){var t=ss.safeCast(n,ss.IDisposable);t&&t.dispose()})});if(typeof t!=c){if(typeof t.length==u)return new E(t);if(!(t instanceof Object)&&f.isIEnumerable(t))return new m(function(){var n,r=!0;return new h(function(){n=new Enumerator(t)},function(){return r?r=!1:n.moveNext(),!n.atEnd()&&this.yieldReturn(n.item())},e.Blank)});if(typeof Windows===i&&typeof t.first===c)return new m(function(){var n,r=!0;return new h(function(){n=t.first()},function(){return r?r=!1:n.moveNext(),n.hasCurrent?this.yieldReturn(n.current):this.yieldBreak()},e.Blank)})}return new m(function(){var n=[],r=0;return new h(function(){for(var e in t){var r=t[e];r instanceof Function||!Object.prototype.hasOwnProperty.call(t,e)||n.push({key:e,value:r})}},function(){return r<n.length&&this.yieldReturn(n[r++])},e.Blank)})},m.make=function(t){return m.repeat(t,1)},m.matches=function(t,n,r){return null==r&&(r=""),n instanceof RegExp&&(r+=n.ignoreCase?"i":"",r+=n.multiline?"m":"",n=n.source),-1===r.indexOf("g")&&(r+="g"),new m(function(){var u;return new h(function(){u=new RegExp(n,r)},function(){var n=u.exec(t);return!!n&&this.yieldReturn(n)},e.Blank)})},m.range=function(t,n,r){return null==r&&(r=1),new m(function(){var u,o=0;return new h(function(){u=t-r},function(){return o++<n?this.yieldReturn(u+=r):this.yieldBreak()},e.Blank)})},m.rangeDown=function(t,n,r){return null==r&&(r=1),new m(function(){var u,o=0;return new h(function(){u=t+r},function(){return o++<n?this.yieldReturn(u-=r):this.yieldBreak()},e.Blank)})},m.rangeTo=function(t,n,r){return null==r&&(r=1),new m(t<n?function(){var u;return new h(function(){u=t-r},function(){var t=u+=r;return t<=n?this.yieldReturn(t):this.yieldBreak()},e.Blank)}:function(){var u;return new h(function(){u=t+r},function(){var t=u-=r;return t>=n?this.yieldReturn(t):this.yieldBreak()},e.Blank)})},m.repeat=function(t,n){return null!=n?m.repeat(t).take(n):new m(function(){return new h(e.Blank,function(){return this.yieldReturn(t)},e.Blank)})},m.repeatWithFinalize=function(t,n){return t=f.createLambda(t),n=f.createLambda(n),new m(function(){var e;return new h(function(){e=t()},function(){return this.yieldReturn(e)},function(){null!=e&&(n(e),e=null)})})},m.generate=function(t,n){return null!=n?m.generate(t).take(n):(t=f.createLambda(t),new m(function(){return new h(e.Blank,function(){return this.yieldReturn(t())},e.Blank)}))},m.toInfinity=function(t,n){return null==t&&(t=0),null==n&&(n=1),new m(function(){var r;return new h(function(){r=t-n},function(){return this.yieldReturn(r+=n)},e.Blank)})},m.toNegativeInfinity=function(t,n){return null==t&&(t=0),null==n&&(n=1),new m(function(){var r;return new h(function(){r=t+n},function(){return this.yieldReturn(r-=n)},e.Blank)})},m.unfold=function(t,n){return n=f.createLambda(n),new m(function(){var r,u=!0;return new h(e.Blank,function(){return u?(u=!1,r=t,this.yieldReturn(r)):(r=n(r),this.yieldReturn(r))},e.Blank)})},m.defer=function(t){return new m(function(){var n;return new h(function(){n=m.from(t()).getEnumerator()},function(){return n.moveNext()?this.yieldReturn(n.current()):this.yieldBreak()},function(){f.dispose(n)})})},m.prototype.traverseBreadthFirst=function(t,n){var e=this;return t=f.createLambda(t),n=f.createLambda(n),new m(function(){var r,u=0,o=[];return new h(function(){r=e.getEnumerator()},function(){for(;;){if(r.moveNext())return o.push(r.current()),this.yieldReturn(n(r.current(),u));var e=m.from(o).selectMany(function(n){return t(n)});if(!e.any())return!1;u++,o=[],f.dispose(r),r=e.getEnumerator()}},function(){f.dispose(r)})})},m.prototype.traverseDepthFirst=function(t,n){var e=this;return t=f.createLambda(t),n=f.createLambda(n),new m(function(){var r,u=[];return new h(function(){r=e.getEnumerator()},function(){for(;;){if(r.moveNext()){var e=n(r.current(),u.length);return u.push(r),r=m.from(t(r.current())).getEnumerator(),this.yieldReturn(e)}if(u.length<=0)return!1;f.dispose(r),r=u.pop()}},function(){try{f.dispose(r)}finally{m.from(u).forEach(function(t){t.dispose()})}})})},m.prototype.flatten=function(){var t=this;return new m(function(){var n,r=null;return new h(function(){n=t.getEnumerator()},function(){for(;;){if(null!=r){if(r.moveNext())return this.yieldReturn(r.current());r=null}if(n.moveNext()){if(n.current()instanceof Array){f.dispose(r),r=m.from(n.current()).selectMany(e.Identity).flatten().getEnumerator();continue}return this.yieldReturn(n.current())}return!1}},function(){try{f.dispose(n)}finally{f.dispose(r)}})})},m.prototype.recordwise=function(t){var n=this;return t=f.createLambda(t),new m(function(){var e;return new h(function(){(e=n.getEnumerator()).moveNext()},function(){var n=e.current();return!!e.moveNext()&&this.yieldReturn(t(n,e.current()))},function(){f.dispose(e)})})},m.prototype.scan=function(t,n){var e;null==n?(n=f.createLambda(t),e=!1):(n=f.createLambda(n),e=!0);var r=this;return new m(function(){var u,o,i=!0;return new h(function(){u=r.getEnumerator()},function(){if(i){if(i=!1,e)return this.yieldReturn(o=t);if(u.moveNext())return this.yieldReturn(o=u.current())}return!!u.moveNext()&&this.yieldReturn(o=n(o,u.current()))},function(){f.dispose(u)})})},m.prototype.select=function(t){if((t=f.createLambda(t)).length<=1)return new x(this,null,t);var n=this;return new m(function(){var e,r=0;return new h(function(){e=n.getEnumerator()},function(){return!!e.moveNext()&&this.yieldReturn(t(e.current(),r++))},function(){f.dispose(e)})})},m.prototype.selectMany=function(t,e){var r=this;return t=f.createLambda(t),null==e&&(e=function(t,n){return n}),e=f.createLambda(e),new m(function(){var u,o=n,i=0;return new h(function(){u=r.getEnumerator()},function(){if(o===n&&!u.moveNext())return!1;do{if(null==o){var r=t(u.current(),i++);o=m.from(r).getEnumerator()}if(o.moveNext())return this.yieldReturn(e(u.current(),o.current()));f.dispose(o),o=null}while(u.moveNext());return!1},function(){try{f.dispose(u)}finally{f.dispose(o)}})})},m.prototype.where=function(t){if((t=f.createLambda(t)).length<=1)return new b(this,t);var n=this;return new m(function(){var e,r=0;return new h(function(){e=n.getEnumerator()},function(){for(;e.moveNext();)if(t(e.current(),r++))return this.yieldReturn(e.current());return!1},function(){f.dispose(e)})})},m.prototype.choose=function(t){t=f.createLambda(t);var n=this;return new m(function(){var e,r=0;return new h(function(){e=n.getEnumerator()},function(){for(;e.moveNext();){var n=t(e.current(),r++);if(null!=n)return this.yieldReturn(n)}return this.yieldBreak()},function(){f.dispose(e)})})},m.prototype.ofType=function(t){var n=this;return new m(function(){var e;return new h(function(){e=ss.getEnumerator(n)},function(){for(;e.moveNext();){var n=ss.safeCast(e.current(),t);if(ss.isValue(n))return this.yieldReturn(n)}return!1},function(){f.dispose(e)})})},m.prototype.zip=function(){var t=arguments,n=f.createLambda(arguments[arguments.length-1]),e=this;if(2==arguments.length){var r=arguments[0];return new m(function(){var t,u,o=0;return new h(function(){t=e.getEnumerator(),u=m.from(r).getEnumerator()},function(){return!(!t.moveNext()||!u.moveNext())&&this.yieldReturn(n(t.current(),u.current(),o++))},function(){try{f.dispose(t)}finally{f.dispose(u)}})})}return new m(function(){var r,u=0;return new h(function(){var n=m.make(e).concat(m.from(t).takeExceptLast().select(m.from)).select(function(t){return t.getEnumerator()}).toArray();r=m.from(n)},function(){if(r.all(function(t){return t.moveNext()})){var t=r.select(function(t){return t.current()}).toArray();return t.push(u++),this.yieldReturn(n.apply(null,t))}return this.yieldBreak()},function(){m.from(r).forEach(f.dispose)})})},m.prototype.merge=function(){var t=arguments,n=this;return new m(function(){var e,r=-1;return new h(function(){e=m.make(n).concat(m.from(t).select(m.from)).select(function(t){return t.getEnumerator()}).toArray()},function(){for(;e.length>0;){r=r>=e.length-1?0:r+1;var t=e[r];if(t.moveNext())return this.yieldReturn(t.current());t.dispose(),e.splice(r--,1)}return this.yieldBreak()},function(){m.from(e).forEach(f.dispose)})})},m.prototype.join=function(t,r,u,o,i){r=f.createLambda(r),u=f.createLambda(u),o=f.createLambda(o);var a=this;return new m(function(){var c,s,l=null,p=0;return new h(function(){c=a.getEnumerator(),s=m.from(t).toLookup(u,e.Identity,i)},function(){for(;;){if(null!=l){var t=l[p++];if(t!==n)return this.yieldReturn(o(c.current(),t));t=null,p=0}if(!c.moveNext())return!1;var e=r(c.current());l=s.get(e).toArray()}},function(){f.dispose(c)})})},m.prototype.groupJoin=function(t,n,r,u,o){n=f.createLambda(n),r=f.createLambda(r),u=f.createLambda(u);var i=this;return new m(function(){var a=i.getEnumerator(),c=null;return new h(function(){a=i.getEnumerator(),c=m.from(t).toLookup(r,e.Identity,o)},function(){if(a.moveNext()){var t=c.get(n(a.current()));return this.yieldReturn(u(a.current(),t))}return!1},function(){f.dispose(a)})})},m.prototype.all=function(t){t=f.createLambda(t);var n=!0;return this.forEach(function(e){if(!t(e))return n=!1,!1}),n},m.prototype.any=function(t){t=f.createLambda(t);var n=this.getEnumerator();try{if(0==arguments.length)return n.moveNext();for(;n.moveNext();)if(t(n.current()))return!0;return!1}finally{f.dispose(n)}},m.prototype.isEmpty=function(){return!this.any()},m.prototype.concat=function(){var t=this;if(1==arguments.length){var n=arguments[0];return new m(function(){var e,r;return new h(function(){e=t.getEnumerator()},function(){if(null==r){if(e.moveNext())return this.yieldReturn(e.current());r=m.from(n).getEnumerator()}return!!r.moveNext()&&this.yieldReturn(r.current())},function(){try{f.dispose(e)}finally{f.dispose(r)}})})}var e=arguments;return new m(function(){var n;return new h(function(){n=m.make(t).concat(m.from(e).select(m.from)).select(function(t){return t.getEnumerator()}).toArray()},function(){for(;n.length>0;){var t=n[0];if(t.moveNext())return this.yieldReturn(t.current());t.dispose(),n.splice(0,1)}return this.yieldBreak()},function(){m.from(n).forEach(f.dispose)})})},m.prototype.insert=function(t,n){var e=this;return new m(function(){var r,u,o=0,i=!1;return new h(function(){r=e.getEnumerator(),u=m.from(n).getEnumerator()},function(){return o==t&&u.moveNext()?(i=!0,this.yieldReturn(u.current())):r.moveNext()?(o++,this.yieldReturn(r.current())):!(i||!u.moveNext())&&this.yieldReturn(u.current())},function(){try{f.dispose(r)}finally{f.dispose(u)}})})},m.prototype.alternate=function(t){var n=this;return new m(function(){var e,r,u,o;return new h(function(){u=t instanceof Array||null!=t.getEnumerator?m.from(m.from(t).toArray()):m.make(t),(r=n.getEnumerator()).moveNext()&&(e=r.current())},function(){for(;;){if(null!=o){if(o.moveNext())return this.yieldReturn(o.current());o=null}if(null!=e||!r.moveNext()){if(null!=e){var t=e;return e=null,this.yieldReturn(t)}return this.yieldBreak()}e=r.current(),o=u.getEnumerator()}},function(){try{f.dispose(r)}finally{f.dispose(o)}})})},m.prototype.contains=function(t,n){n=n||ss.EqualityComparer.def;var e=this.getEnumerator();try{for(;e.moveNext();)if(n.areEqual(e.current(),t))return!0;return!1}finally{f.dispose(e)}},m.prototype.defaultIfEmpty=function(t){var e=this;return t===n&&(t=null),new m(function(){var n,r=!0;return new h(function(){n=e.getEnumerator()},function(){return n.moveNext()?(r=!1,this.yieldReturn(n.current())):!!r&&(r=!1,this.yieldReturn(t))},function(){f.dispose(n)})})},m.prototype.distinct=function(t){return this.except(m.empty(),t)},m.prototype.distinctUntilChanged=function(t){t=f.createLambda(t);var n=this;return new m(function(){var e,r,u;return new h(function(){e=n.getEnumerator()},function(){for(;e.moveNext();){var n=t(e.current());if(u)return u=!1,r=n,this.yieldReturn(e.current());if(r!==n)return r=n,this.yieldReturn(e.current())}return this.yieldBreak()},function(){f.dispose(e)})})},m.prototype.except=function(t,n){var e=this;return new m(function(){var r,u;return new h(function(){r=e.getEnumerator(),u=new(ss.makeGenericType(ss.Dictionary$2,[Object,Object]))(null,n),m.from(t).forEach(function(t){u.add(t)})},function(){for(;r.moveNext();){var t=r.current();if(!u.containsKey(t))return u.add(t),this.yieldReturn(t)}return!1},function(){f.dispose(r)})})},m.prototype.intersect=function(t,n){var e=this;return new m(function(){var r,u,o;return new h(function(){r=e.getEnumerator(),u=new(ss.makeGenericType(ss.Dictionary$2,[Object,Object]))(null,n),m.from(t).forEach(function(t){u.add(t)}),o=new(ss.makeGenericType(ss.Dictionary$2,[Object,Object]))(null,n)},function(){for(;r.moveNext();){var t=r.current();if(!o.containsKey(t)&&u.containsKey(t))return o.add(t),this.yieldReturn(t)}return!1},function(){f.dispose(r)})})},m.prototype.sequenceEqual=function(t,n){n=n||ss.EqualityComparer.def;var e=this.getEnumerator();try{var r=m.from(t).getEnumerator();try{for(;e.moveNext();)if(!r.moveNext()||!n.areEqual(e.current(),r.current()))return!1;return!r.moveNext()}finally{f.dispose(r)}}finally{f.dispose(e)}},m.prototype.union=function(t,e){var r=this;return new m(function(){var u,o,i;return new h(function(){u=r.getEnumerator(),i=new(ss.makeGenericType(ss.Dictionary$2,[Object,Object]))(null,e)},function(){var e;if(o===n){for(;u.moveNext();)if(e=u.current(),!i.containsKey(e))return i.add(e),this.yieldReturn(e);o=m.from(t).getEnumerator()}for(;o.moveNext();)if(e=o.current(),!i.containsKey(e))return i.add(e),this.yieldReturn(e);return!1},function(){try{f.dispose(u)}finally{f.dispose(o)}})})},m.prototype.orderBy=function(t,n){return new v(this,t,n,!1)},m.prototype.orderByDescending=function(t,n){return new v(this,t,n,!0)},m.prototype.reverse=function(){var t=this;return new m(function(){var n,r;return new h(function(){n=t.toArray(),r=n.length},function(){return r>0&&this.yieldReturn(n[--r])},e.Blank)})},m.prototype.shuffle=function(){var t=this;return new m(function(){var n;return new h(function(){n=t.toArray()},function(){if(n.length>0){var t=Math.floor(Math.random()*n.length);return this.yieldReturn(n.splice(t,1)[0])}return!1},e.Blank)})},m.prototype.weightedSample=function(t){t=f.createLambda(t);var n=this;return new m(function(){var r,u=0;return new h(function(){r=n.choose(function(n){var e=t(n);return e<=0?null:{value:n,bound:u+=e}}).toArray()},function(){if(r.length>0){for(var t=Math.floor(Math.random()*u)+1,n=-1,e=r.length;e-n>1;){var o=Math.floor((n+e)/2);r[o].bound>=t?e=o:n=o}return this.yieldReturn(r[e].value)}return this.yieldBreak()},e.Blank)})},m.prototype.groupBy=function(t,n,e,r){var u=this;return t=f.createLambda(t),n=f.createLambda(n),null!=e&&(e=f.createLambda(e)),new m(function(){var o;return new h(function(){o=u.toLookup(t,n,r).toEnumerable().getEnumerator()},function(){for(;o.moveNext();)return null==e?this.yieldReturn(o.current()):this.yieldReturn(e(o.current().key(),o.current()));return!1},function(){f.dispose(o)})})},m.prototype.partitionBy=function(t,n,e,r){var u,o=this;return t=f.createLambda(t),n=f.createLambda(n),r=r||ss.EqualityComparer.def,null==e?(u=!1,e=function(t,n){return new R(t,n)}):(u=!0,e=f.createLambda(e)),new m(function(){var i,a,c=[];return new h(function(){(i=o.getEnumerator()).moveNext()&&(a=t(i.current()),c.push(n(i.current())))},function(){for(var o;1==(o=i.moveNext())&&r.areEqual(a,t(i.current()));)c.push(n(i.current()));if(c.length>0){var f=e(a,u?m.from(c):c);return o?(a=t(i.current()),c=[n(i.current())]):c=[],this.yieldReturn(f)}return!1},function(){f.dispose(i)})})},m.prototype.buffer=function(t){var n=this;return new m(function(){var e;return new h(function(){e=n.getEnumerator()},function(){for(var n=[],r=0;e.moveNext();)if(n.push(e.current()),++r>=t)return this.yieldReturn(n);return n.length>0&&this.yieldReturn(n)},function(){f.dispose(e)})})},m.prototype.aggregate=function(t,n,e){return(e=f.createLambda(e))(this.scan(t,n,e).last())},m.prototype.average=function(t){t=f.createLambda(t);var n=0,e=0;return this.forEach(function(r){n+=t(r),++e}),n/e},m.prototype.count=function(t){t=null==t?e.True:f.createLambda(t);var n=0;return this.forEach(function(e,r){t(e,r)&&++n}),n},m.prototype.max=function(t){return null==t&&(t=e.Identity),this.select(t).aggregate(function(t,n){return t>n?t:n})},m.prototype.min=function(t){return null==t&&(t=e.Identity),this.select(t).aggregate(function(t,n){return t<n?t:n})},m.prototype.maxBy=function(t){return t=f.createLambda(t),this.aggregate(function(n,e){return t(n)>t(e)?n:e})},m.prototype.minBy=function(t){return t=f.createLambda(t),this.aggregate(function(n,e){return t(n)<t(e)?n:e})},m.prototype.sum=function(t){return null==t&&(t=e.Identity),this.select(t).aggregate(0,function(t,n){return t+n})},m.prototype.elementAt=function(t){var n,e=!1;if(this.forEach(function(r,u){if(u==t)return n=r,e=!0,!1}),!e)throw new Error("index is less than 0 or greater than or equal to the number of elements in source.");return n},m.prototype.elementAtOrDefault=function(t,e){var r;e===n&&(e=null);var u=!1;return this.forEach(function(n,e){if(e==t)return r=n,u=!0,!1}),u?r:e},m.prototype.first=function(t){if(null!=t)return this.where(t).first();var n,e=!1;if(this.forEach(function(t){return n=t,e=!0,!1}),!e)throw new Error("first:No element satisfies the condition.");return n},m.prototype.firstOrDefault=function(t,e){if(e===n&&(e=null),null!=t)return this.where(t).firstOrDefault(null,e);var r,u=!1;return this.forEach(function(t){return r=t,u=!0,!1}),u?r:e},m.prototype.last=function(t){if(null!=t)return this.where(t).last();var n,e=!1;if(this.forEach(function(t){e=!0,n=t}),!e)throw new Error("last:No element satisfies the condition.");return n},m.prototype.lastOrDefault=function(t,e){if(e===n&&(e=null),null!=t)return this.where(t).lastOrDefault(null,e);var r,u=!1;return this.forEach(function(t){u=!0,r=t}),u?r:e},m.prototype.single=function(t){if(null!=t)return this.where(t).single();var n,e=!1;if(this.forEach(function(t){if(e)throw new Error("single:sequence contains more than one element.");e=!0,n=t}),!e)throw new Error("single:No element satisfies the condition.");return n},m.prototype.singleOrDefault=function(t,e){if(e===n&&(e=null),null!=t)return this.where(t).singleOrDefault(null,e);var r,u=!1;return this.forEach(function(t){if(u)throw new Error("single:sequence contains more than one element.");u=!0,r=t}),u?r:e},m.prototype.skip=function(t){var n=this;return new m(function(){var e,r=0;return new h(function(){for(e=n.getEnumerator();r++<t&&e.moveNext(););},function(){return!!e.moveNext()&&this.yieldReturn(e.current())},function(){f.dispose(e)})})},m.prototype.skipWhile=function(t){t=f.createLambda(t);var n=this;return new m(function(){var e,r=0,u=!1;return new h(function(){e=n.getEnumerator()},function(){for(;!u;){if(!e.moveNext())return!1;if(!t(e.current(),r++))return u=!0,this.yieldReturn(e.current())}return!!e.moveNext()&&this.yieldReturn(e.current())},function(){f.dispose(e)})})},m.prototype.take=function(t){var n=this;return new m(function(){var e,r=0;return new h(function(){e=n.getEnumerator()},function(){return!!(r++<t&&e.moveNext())&&this.yieldReturn(e.current())},function(){f.dispose(e)})})},m.prototype.takeWhile=function(t){t=f.createLambda(t);var n=this;return new m(function(){var e,r=0;return new h(function(){e=n.getEnumerator()},function(){return!(!e.moveNext()||!t(e.current(),r++))&&this.yieldReturn(e.current())},function(){f.dispose(e)})})},m.prototype.takeExceptLast=function(t){null==t&&(t=1);var n=this;return new m(function(){if(t<=0)return n.getEnumerator();var e,r=[];return new h(function(){e=n.getEnumerator()},function(){for(;e.moveNext();){if(r.length==t)return r.push(e.current()),this.yieldReturn(r.shift());r.push(e.current())}return!1},function(){f.dispose(e)})})},m.prototype.takeFromLast=function(t){if(t<=0||null==t)return m.empty();var n=this;return new m(function(){var e,r,u=[];return new h(function(){e=n.getEnumerator()},function(){for(;e.moveNext();)u.length==t&&u.shift(),u.push(e.current());return null==r&&(r=m.from(u).getEnumerator()),!!r.moveNext()&&this.yieldReturn(r.current())},function(){f.dispose(r)})})},m.prototype.indexOf=function(t,n){var e=null;return typeof t===c?this.forEach(function(n,r){if(t(n,r))return e=r,!1}):(n=n||ss.EqualityComparer.def,this.forEach(function(r,u){if(n.areEqual(r,t))return e=u,!1})),null!==e?e:-1},m.prototype.lastIndexOf=function(t,n){var e=-1;return typeof t===c?this.forEach(function(n,r){t(n,r)&&(e=r)}):(n=n||ss.EqualityComparer.def,this.forEach(function(r,u){n.areEqual(r,t)&&(e=u)})),e},m.prototype.asEnumerable=function(){return m.from(this)},m.prototype.toArray=function(){var t=[];return this.forEach(function(n){t.push(n)}),t},m.prototype.toLookup=function(t,n,e){t=f.createLambda(t),n=f.createLambda(n);var r=new(ss.makeGenericType(ss.Dictionary$2,[Object,Object]))(null,e),u=[];return this.forEach(function(e){var o=t(e),i=n(e),a={$:null};r.tryGetValue(o,a)?a.$.push(i):(u.push(o),r.add(o,[i]))}),new k(r,u)},m.prototype.toObject=function(t,n){t=f.createLambda(t),n=f.createLambda(n);var e={};return this.forEach(function(r){e[t(r)]=n(r)}),e},m.prototype.toDictionary=function(t,n,e,r,u){t=f.createLambda(t),n=f.createLambda(n);var o=new(ss.makeGenericType(ss.Dictionary$2,[e,r]))(null,u);return this.forEach(function(e){o.add(t(e),n(e))}),o},m.prototype.toJSONString=function(t,n){if(typeof JSON===a||null==JSON.stringify)throw new Error("toJSONString can't find JSON.stringify. This works native JSON support Browser or include json2.js");return JSON.stringify(this.toArray(),t,n)},m.prototype.toJoinedString=function(t,n){return null==t&&(t=""),null==n&&(n=e.Identity),this.select(n).toArray().join(t)},m.prototype.doAction=function(t){var n=this;return t=f.createLambda(t),new m(function(){var e,r=0;return new h(function(){e=n.getEnumerator()},function(){return!!e.moveNext()&&(t(e.current(),r++),this.yieldReturn(e.current()))},function(){f.dispose(e)})})},m.prototype.forEach=function(t){t=f.createLambda(t);var n=0,e=this.getEnumerator();try{for(;e.moveNext()&&!1!==t(e.current(),n++););}finally{f.dispose(e)}},m.prototype.write=function(t,n){null==t&&(t=""),n=f.createLambda(n);var e=!0;this.forEach(function(r){e?e=!1:document.write(t),document.write(n(r))})},m.prototype.writeLine=function(t){t=f.createLambda(t),this.forEach(function(n){document.writeln(t(n)+"<br />")})},m.prototype.force=function(){var t=this.getEnumerator();try{for(;t.moveNext(););}finally{f.dispose(t)}},m.prototype.letBind=function(t){t=f.createLambda(t);var n=this;return new m(function(){var e;return new h(function(){e=m.from(t(n)).getEnumerator()},function(){return!!e.moveNext()&&this.yieldReturn(e.current())},function(){f.dispose(e)})})},m.prototype.share=function(){var t,n=this,r=!1;return new g(function(){return new h(function(){null==t&&(t=n.getEnumerator())},function(){if(r)throw new Error("enumerator is disposed");return!!t.moveNext()&&this.yieldReturn(t.current())},e.Blank)},function(){r=!0,f.dispose(t)})},m.prototype.memoize=function(){var t,n,r=this,u=!1;return new g(function(){var o=-1;return new h(function(){null==n&&(n=r.getEnumerator(),t=[])},function(){if(u)throw new Error("enumerator is disposed");return o++,t.length<=o?!!n.moveNext()&&this.yieldReturn(t[o]=n.current()):this.yieldReturn(t[o])},e.Blank)},function(){u=!0,f.dispose(n),t=null})},m.prototype.catchError=function(t){t=f.createLambda(t);var n=this;return new m(function(){var e;return new h(function(){e=n.getEnumerator()},function(){try{return!!e.moveNext()&&this.yieldReturn(e.current())}catch(n){return t(n),!1}},function(){f.dispose(e)})})},m.prototype.finallyAction=function(t){t=f.createLambda(t);var n=this;return new m(function(){var e;return new h(function(){e=n.getEnumerator()},function(){return!!e.moveNext()&&this.yieldReturn(e.current())},function(){try{f.dispose(e)}finally{t()}})})},m.prototype.log=function(t){return t=f.createLambda(t),this.doAction(function(t){})},m.prototype.trace=function(t,n){return null==t&&(t="Trace"),n=f.createLambda(n),this.doAction(function(t){})};var v=function(t,n,e,r,u){this.source=t,this.keySelector=f.createLambda(n),this.comparer=e||ss.Comparer.def,this.descending=r,this.parent=u};v.prototype=new m,v.prototype.createOrderedEnumerable=function(t,n,e){return new v(this.source,t,n,e,this)},v.prototype.thenBy=function(t,n){return this.createOrderedEnumerable(t,n,!1)},v.prototype.thenByDescending=function(t,n){return this.createOrderedEnumerable(t,n,!0)},v.prototype.getEnumerator=function(){var t,n,r=this,u=0;return new h(function(){t=[],n=[],r.source.forEach(function(e,r){t.push(e),n.push(r)});var e=w.create(r,null);e.GenerateKeys(t),n.sort(function(t,n){return e.compare(t,n)})},function(){return u<n.length&&this.yieldReturn(t[n[u++]])},e.Blank)};var w=function(t,n,e,r){this.keySelector=t,this.comparer=n,this.descending=e,this.child=r,this.keys=null};w.create=function(t,n){var e=new w(t.keySelector,t.comparer,t.descending,n);return null!=t.parent?w.create(t.parent,e):e},w.prototype.GenerateKeys=function(t){for(var n=t.length,e=this.keySelector,r=new Array(n),u=0;u<n;u++)r[u]=e(t[u]);this.keys=r,null!=this.child&&this.child.GenerateKeys(t)},w.prototype.compare=function(t,n){var e=this.comparer.compare(this.keys[t],this.keys[n]);return 0==e?null!=this.child?this.child.compare(t,n):f.compare(t,n):this.descending?-e:e};var g=function(t,n){this.dispose=n,m.call(this,t)};g.prototype=new m;var E=function(t){this.getSource=function(){return t}};E.prototype=new m,E.prototype.any=function(t){return null==t?this.getSource().length>0:m.prototype.any.apply(this,arguments)},E.prototype.count=function(t){return null==t?this.getSource().length:m.prototype.count.apply(this,arguments)},E.prototype.elementAt=function(t){var n=this.getSource();return 0<=t&&t<n.length?n[t]:m.prototype.elementAt.apply(this,arguments)},E.prototype.elementAtOrDefault=function(t,e){e===n&&(e=null);var r=this.getSource();return 0<=t&&t<r.length?r[t]:e},E.prototype.first=function(t){var n=this.getSource();return null==t&&n.length>0?n[0]:m.prototype.first.apply(this,arguments)},E.prototype.firstOrDefault=function(t,e){if(e===n&&(e=null),null!=t)return m.prototype.firstOrDefault.apply(this,arguments);var r=this.getSource();return r.length>0?r[0]:e},E.prototype.last=function(t){var n=this.getSource();return null==t&&n.length>0?n[n.length-1]:m.prototype.last.apply(this,arguments)},E.prototype.lastOrDefault=function(t,e){if(e===n&&(e=null),null!=t)return m.prototype.lastOrDefault.apply(this,arguments);var r=this.getSource();return r.length>0?r[r.length-1]:e},E.prototype.skip=function(t){var n=this.getSource();return new m(function(){var r;return new h(function(){r=t<0?0:t},function(){return r<n.length&&this.yieldReturn(n[r++])},e.Blank)})},E.prototype.takeExceptLast=function(t){return null==t&&(t=1),this.take(this.getSource().length-t)},E.prototype.takeFromLast=function(t){return this.skip(this.getSource().length-t)},E.prototype.reverse=function(){var t=this.getSource();return new m(function(){var n;return new h(function(){n=t.length},function(){return n>0&&this.yieldReturn(t[--n])},e.Blank)})},E.prototype.sequenceEqual=function(t,n){return(!(t instanceof E||t instanceof Array)||null!=n||m.from(t).count()==this.count())&&m.prototype.sequenceEqual.apply(this,arguments)},E.prototype.toJoinedString=function(t,n){var e=this.getSource();return null==n&&e instanceof Array?(null==t&&(t=""),e.join(t)):m.prototype.toJoinedString.apply(this,arguments)},E.prototype.getEnumerator=function(){return new ss.ArrayEnumerator(this.getSource())};var b=function(t,n){this.prevSource=t,this.prevPredicate=n};b.prototype=new m,b.prototype.where=function(t){if((t=f.createLambda(t)).length<=1){var n=this.prevPredicate;return new b(this.prevSource,function(e){return n(e)&&t(e)})}return m.prototype.where.call(this,t)},b.prototype.select=function(t){return(t=f.createLambda(t)).length<=1?new x(this.prevSource,this.prevPredicate,t):m.prototype.select.call(this,t)},b.prototype.getEnumerator=function(){var t,n=this.prevPredicate,e=this.prevSource;return new h(function(){t=e.getEnumerator()},function(){for(;t.moveNext();)if(n(t.current()))return this.yieldReturn(t.current());return!1},function(){f.dispose(t)})};var x=function(t,n,e){this.prevSource=t,this.prevPredicate=n,this.prevSelector=e};x.prototype=new m,x.prototype.where=function(t){return(t=f.createLambda(t)).length<=1?new b(this,t):m.prototype.where.call(this,t)},x.prototype.select=function(t){if((t=f.createLambda(t)).length<=1){var n=this.prevSelector;return new x(this.prevSource,this.prevPredicate,function(e){return t(n(e))})}return m.prototype.select.call(this,t)},x.prototype.getEnumerator=function(){var t,n=this.prevPredicate,e=this.prevSelector,r=this.prevSource;return new h(function(){t=r.getEnumerator()},function(){for(;t.moveNext();)if(null==n||n(t.current()))return this.yieldReturn(e(t.current()));return!1},function(){f.dispose(t)})};var k=function(t,n){this.count=function(){return t.get_count()},this.get=function(n){var e={$:null},r=t.tryGetValue(n,e);return m.from(r?e.$:[])},this.contains=function(n){return t.containsKey(n)},this.toEnumerable=function(){return m.from(n).select(function(n){return new R(n,t.get_item(n))})},this.getEnumerator=function(){return this.toEnumerable().getEnumerator()}};ss.initClass(k,y,{},null,[ss.IEnumerable]);var R=function(t,n){this.key=function(){return t},E.call(this,n)};R.prototype=new E,typeof define===c&&define.amd?(define("linqjs",[],function(){return m}),t.Enumerable=m):typeof module!==a&&module.exports?(module.exports=m,global.Enumerable=m):t.Enumerable=m}(this);
